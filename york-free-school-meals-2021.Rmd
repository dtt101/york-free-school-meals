---
title: "Mapping free school meals in York, UK. 2021"
output: html_notebook
---



# Task

What can we learn about child poverty in York from published free school meals data?

# Data Sources

Data Source: https://data.yorkopendata.org/dataset/free-school-meals/resource/03b0ae33-f6fe-4431-94f8-4b811c8921ba

# Data Preparation & Processing

 * FSMTaken stops being recorded in 2018
 * Schools are recorded multiple times with different names
 * 9999 is used as a value for FSMTaken and TotalFSM when count <5 upto 2017; https://stackoverflow.com/questions/21187603/replace-characters-from-a-column-of-a-data-frame-r
 * TotalFSM is a <chr> 

# Analysis

Load core libraries

```{r}
library(tidyverse)  #helps wrangle data
library(ggplot2)  #helps visualize data
```

Load data:

```{r}
fsmraw <- read_csv("csv/fsmdetails.csv")
```

Remove FSMTaken as it stops being recorded in 2018:

```{r}
fsmdetails <- fsmraw %>% select(-FSMTaken)
```

Create pivot table 

```{r}
fsmdetails %>%
  group_by(SchoolName, Year) %>%
  summarise(SchoolName)

```

## Make school names consistent with the latest (2020)

```{r}
fsmdetails$SchoolName[fsmdetails$SchoolName == "All Saints RC"] <- "All Saints RC School"
```


```{r}
oldSchool = c(
  "All Saints RC",
  "Applefields",
  "Archbishop Holgate's CE",
  "Archbishop of York's CE Junior School",
  "Archbishop Of Yorks Ce Junior",
  "Badger Hill Primary",
  "Canon Lee",
  "Fulford",
  "Hob Moor Oaks",
  "Huntington",
  "Huntington Primary School",
  "Joseph Rowntree",
  "Lord Deramore's VC Primary School",
  "Manor CE",
  "Millthorpe",
  "Our Lady Queen of Martyrs Primary School",
  "Park Grove Primary School",
  "Robert Wilkinson Academy Primary School",
  "Robert Wilkinson Primary Academy"
)

newSchool = c(
  "All Saints RC School",
  "Applefields School",
  "Archbishop Holgates CE School",
  "Archbishop Of Yorks CE Junior",
  "Archbishop Of Yorks CE Junior",
  "Badger Hill Primary School",
  "Canon Lee Specialist Arts College",
  "Fulford School",
  "Hob Moor Oaks School",
  "Huntington School",
  "Huntington Primary Academy",
  "Joseph Rowntree School",
  "Lord Deramores Primary School",
  "Manor CE Academy",
  "Millthorpe School",
  "Our Lady Queen of Martyrs RC Primary School",
  "Park Grove Primary Academy",
  "Robert Wilkinson Primary School",
  "Robert Wilkinson Primary School"
)

renameSchools <- cbind(oldSchool, newSchool)
for(i in 1:nrow(renameSchools)) {
  oldName = renameSchools[i,][1]
  newName  = renameSchools[i,][2]
  fsmdetails$SchoolName[fsmdetails$SchoolName == oldName] <- newName
}
```


St Aelred's RCVA Primary = St Aelred's RC Primary School	
St Aelreds Rc Primary School = St Aelred's RC Primary School	
St Aelreds RC Primary School = St Aelred's RC Primary School
St Barnabas C Of E Primary School = St Barnabas' CE Primary School	
St Barnabas CE Primary School	= St Barnabas' CE Primary School
St Georges Rc Primary School = St George's RC Primary School	
St Georges RC Primary School = St George's RC Primary School
St Lawrence's Primary School = St Lawrence's CE Primary School	
St Lawrences CE Primary School = St Lawrence's CE Primary School
St Marys CE Primary School = St Mary's CE Primary School
St Marys Ce Primary School = St Mary's CE Primary School
St Oswald's Primary School = St Oswald's CE Primary School	
St Oswalds Ce Primary School = St Oswald's CE Primary School	
St Oswalds CE Primary School = St Oswald's CE Primary School
St Pauls Ce Primary School = St Paul's CE Primary School	
St Pauls CE Primary School = St Paul's CE Primary School
St Wilfrid's Primary School	= St Wilfrid's RC Primary School
Stockton-on-the-Forest Primary School	= Stockton On The Forest Primary School	
Vale of York = Vale of York Academy		
Westfield Primary Community School = Westfield Community Primary School
Wheldrake CE (Aided) School	= Wheldrake with Thorganby CE Primary School	
Wheldrake with Thorganby C.E. (Aided) School = Wheldrake with Thorganby CE Primary School	
York High	= York High School	

## Replace values <5 and 9999 for 2 in TotalFSM

I have opted for 2 as a replacement value because it is the median of the value of less than 5.

```{r}
fsmdetails$TotalFSM[fsmdetails$TotalFSM == '9999'] <- '2'
fsmdetails$TotalFSM[fsmdetails$TotalFSM == '<5'] <- '2'
```

## Change TotalFSM from <chr> to <int>

```{r}
fsmdetails$TotalFSM <- as.numeric(as.character(fsmdetails$TotalFSM))
```

# Key findings

Look at percentage of pupils over time, as well as raw number

# Supporting visualisations

# Top 3 Recommendations